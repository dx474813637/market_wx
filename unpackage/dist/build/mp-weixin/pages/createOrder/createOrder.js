(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/createOrder/createOrder"],{"0095":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n("a34a"));function a(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n,r,a,c,i){try{var s=t[c](i),u=s.value}catch(o){return void n(o)}s.done?e(u):Promise.resolve(u).then(r,a)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function s(t){c(i,r,a,s,u,"next",t)}function u(t){c(i,r,a,s,u,"throw",t)}s(void 0)}))}}var s={data:function(){return{addrTabs:0,zt_name:"您当前交收方式为：上门自提",maskState:0,desc:"",couponList:[],addressData:{name:"收货人",mobile:"手机号",address:"详细地址",regional_name:"地区",auto:0},cartList:[],cartList1:[],cartList2:[],couponMoney:0,p:1,endFlag:!1,loadStatus:"loadmore",show:!1,chooseCoupon:"",sz_checked:!1,rz_checked:!1,szObj:{sz:0,sz_info:"",sz_name:""},rzObj:{rz:0,rz_info:"",rz_name:""},ziti:0,shopIdObj:{}}},watch:{sz_checked:function(t){t&&(this.rz_checked=!1)},rz_checked:function(t){t&&(this.sz_checked=!1)}},onLoad:function(e){var n=this;return i(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n.getdefaultaddr(),t.showLoading(),e.next=4,n.getData();case 4:n.getShopsz();case 5:case"end":return e.stop()}}),e)})))()},mounted:function(){t.setNavigationBarColor({frontColor:"#ffffff",backgroundColor:"#5770bd",animation:{duration:400,timingFunc:"easeIn"}})},computed:{switchBtn:function(){return this.$store.state.theme.themeColor},totalPrice:function(){var t=0;return this.cartList.forEach((function(e){"议价"==e.price&&(e.price=0),t+=e.price*e.num}),0),t.toFixed(2)},totalPriceAct:function(){return this.totalPrice-this.couponMoney},createOrderData:function(){return this.cartList.map((function(t){return{cid:t.cid,pid:t.sid,num:t.num}}))}},methods:{handlerChangeTabs:function(t){1==this.ziti&&0==t||(this.addrTabs=t)},getdefaultaddr:function(){var t=this;return i(r.default.mark((function e(){var n,a;return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("Xcx/addresss_list");case 2:n=e.sent,1==n.data.code&&(t.zt_name=n.data.zt_name,a=n.data.list.list.filter((function(t){return 1==t.auto}))[0],a&&(t.addressData=a));case 4:case"end":return e.stop()}}),e)})))()},getData:function(){var e=this;return i(r.default.mark((function n(){var a;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.cartList=t.getStorageSync("cart").filter((function(t){return t.checked})),e.cartList.forEach((function(t,n){t.sz=0,e.shopIdObj.hasOwnProperty(t.login)||(e.shopIdObj[t.login]=1),t.self&&t.self.includes(2)&&(e.ziti=1,e.addrTabs=1),t.self&&t.self.includes(1)&&2==t.talk_price?e.cartList2.push(t):e.cartList1.push(t)})),n.next=4,e.get_sinopay_credit();case 4:a=n.sent,1==a.data.code&&(e.szObj.sz=a.data.sz,e.szObj.sz_name=a.data.sz_name,e.szObj.sz_info=a.data.sz_info,e.rzObj.rz=a.data.rz,e.rzObj.rz_name=a.data.rz_name,e.rzObj.rz_info=a.data.rz_info);case 6:case"end":return n.stop()}}),n)})))()},getShopsz:function(){var t=this;return i(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Object.keys(t.shopIdObj).forEach(function(){var e=i(r.default.mark((function e(n){var a;return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/Market/api.html?api_url_xcx=pay_credit",{params:{login:n}});case 2:if(a=e.sent,1==a.data.code){e.next=5;break}return e.abrupt("return");case 5:t.shopIdObj[n]=a.data.sz,t.cartList1&&t.cartList1.length>0&&(t.cartList1=t.cartList1.map((function(e){return e.sz=t.shopIdObj[e.login],e}))),t.cartList2&&t.cartList2.length>0&&(t.cartList2=t.cartList2.map((function(e){return e.sz=t.shopIdObj[e.login],e})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})))()},get_sinopay_credit:function(){var t=this;return i(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("Xcx/sinopay_credit");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},toggleMask:function(t){this.show=!0},addrcheck:function(){return!!this.addressData.id},submit:function(){var e=this;return i(r.default.mark((function n(){var a,c,i,s;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.addrcheck();case 2:if(a=n.sent,a||0!=e.addrTabs){n.next=6;break}return t.showToast({title:"请选择收货地址",icon:"none"}),n.abrupt("return");case 6:return c=0,e.sz_checked&&(c=1),e.rz_checked&&(c=2),i=1==e.addrTabs?-1:e.addressData.id,n.next=12,e.$http.get("Xcx/create_order",{params:{pid_array:JSON.stringify(e.createOrderData),address_id:i,tool:c}});case 12:s=n.sent,1==s.data.code&&(e.setCart(),t.redirectTo({url:"/pages/order/order"}),t.showToast({title:"订单创建成功"}));case 14:case"end":return n.stop()}}),n)})))()},setCart:function(){var e=this,n=t.getStorageSync("cart");n=n.filter((function(t){var n=e.createOrderData.some((function(e){if(e.pid==t.sid)return!0}));return!n}))||[],t.setStorageSync("cart",n),this.$store.commit("setCartCount",n.length)}}};e.default=s}).call(this,n("543d")["default"])},"1d47":function(t,e,n){"use strict";var r=n("b421"),a=n.n(r);a.a},"273d":function(t,e,n){"use strict";n.r(e);var r=n("0095"),a=n.n(r);for(var c in r)"default"!==c&&function(t){n.d(e,t,(function(){return r[t]}))}(c);e["default"]=a.a},"3c8a":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return r}));var r={uImage:function(){return n.e("node-modules/uview-ui/components/u-image/u-image").then(n.bind(null,"a539"))},uSwitch:function(){return n.e("node-modules/uview-ui/components/u-switch/u-switch").then(n.bind(null,"c6ac"))}},a=function(){var t=this,e=t.$createElement;t._self._c},c=[]},"4c25":function(t,e,n){},b421:function(t,e,n){},bf26:function(t,e,n){"use strict";(function(t){n("0df7");r(n("66fd"));var e=r(n("d9bb"));function r(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},c9e5:function(t,e,n){"use strict";var r=n("4c25"),a=n.n(r);a.a},d9bb:function(t,e,n){"use strict";n.r(e);var r=n("3c8a"),a=n("273d");for(var c in a)"default"!==c&&function(t){n.d(e,t,(function(){return a[t]}))}(c);n("1d47"),n("c9e5");var i,s=n("f0c5"),u=Object(s["a"])(a["default"],r["b"],r["c"],!1,null,"7ad1265a",null,!1,r["a"],i);e["default"]=u.exports}},[["bf26","common/runtime","common/vendor"]]]);