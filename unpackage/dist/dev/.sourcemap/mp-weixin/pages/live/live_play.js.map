{"version":3,"sources":["uni-app:///main.js","webpack:///F:/dx文件/code/wp/wangpu/pages/live/live_play.vue?2446","webpack:///F:/dx文件/code/wp/wangpu/pages/live/live_play.vue?2762","webpack:///F:/dx文件/code/wp/wangpu/pages/live/live_play.vue?15f1","webpack:///F:/dx文件/code/wp/wangpu/pages/live/live_play.vue?fdc5","uni-app:///pages/live/live_play.vue","webpack:///F:/dx文件/code/wp/wangpu/pages/live/live_play.vue?4e0b","webpack:///F:/dx文件/code/wp/wangpu/pages/live/live_play.vue?cb98"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,oG;AACAA,UAAU,CAACC,kBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkI;AAClI;AAC6D;AACL;AACsC;;;AAG9F;AACyK;AACzK,gBAAgB,6KAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,gGAAM;AACR,EAAE,yGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAooB,CAAgB,mnBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACsGxpB,+C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAHA,+D,0nBAIA,EACA,cACA,wBADA,EAEA,sBAFA,EADA,EAKA,IALA,kBAKA,CACA,SACA,WACA,cADA,EAEA,OAFA,EAGA,QAHA,EAIA,UAJA,EADA,EAOA,YACA,QADA,EAEA,UAFA,EAGA,UAHA,EAIA,WAJA,EAKA,YALA,EAPA,EAcA,aAdA,EAeA,SAfA,EAgBA,KAhBA,EAiBA,YAjBA,EAkBA,eAlBA,EAmBA,WAnBA,EAoBA;AACA,iBArBA,EAsBA,sBACA,kBADA,EAtBA,EAyBA,gCAzBA,EA0BA,eA1BA,EA2BA,gBA3BA,EA4BA,gBACA,IADA,EAEA,QAFA,EAGA,aAHA,EAIA,WAJA,EA5BA,EAkCA,SAlCA,EAmCA,YAnCA,EAoCA,cApCA,EAqCA,cArCA,EAsCA,aAtCA,EAuCA,WAvCA,EAwCA,eAxCA,GA0CA,CAhDA,EAiDA,SACA,YACA,OADA,mBACA,GADA,EACA,EADA,EADA,EAIA,SACA,OADA,mBACA,GADA,EACA,CACA;AACA,OAHA,EAJA,EASA,kBATA,8BASA,MATA,EASA,MATA,EASA,CACA,yBACA,OACA,CACA,qCACA,kBACA,gDACA,oDACA,oBACA,CAFA,MAEA,kCACA,uDAEA,oCACA,CACA,CALA,MAKA,mEACA,oCACA,gDACA,oBACA,CAFA,MAEA,gDACA,oBACA,CACA,CACA,mEACA,CACA,CACA,6BACA,qBACA,CACA,CArCA,EAjDA,EAyFA,0CACA,sBACA,yFADA,EAEA,8DAFA,GADA,SAKA,SALA,uBAKA,CACA,mCACA,CAPA,EAQA,SARA,uBAQA,CACA,mCACA,CAVA,GAzFA;;AAqGA,SArGA,qBAqGA;AACA;AACA;AACA;AACA;AACA,KAFA;AAGA;AACA;AACA,GA7GA;AA8GA,QA9GA,kBA8GA,OA9GA,EA8GA;AACA;AACA;AACA,KAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA,wBADA;;AAGA,GAzHA;;AA2HA,UA3HA,sBA2HA,EA3HA;AA4HA,WA5HA,uBA4HA;AACA;AACA,yBADA;;AAGA,GAhIA;AAiIA,SAjIA,qBAiIA;AACA;AACA;AACA;AACA,UADA,CACA,YADA;AAEA,sBAFA,CAEA;AACA;AACA;AACA,KALA;AAMA,QANA;AAOA,GA3IA;AA4IA;AACA,oBADA,8BACA;AACA;AACA;AACA,qCADA;AAEA,uCAFA;;AAIA;AACA,UADA,CACA;AACA;AACA;AACA,6BADA;AAEA,+CAFA;;AAIA;AACA,YADA,CACA,wBADA;AAEA,aAFA,CAEA;AACA,mDADA,CACA;AACA,SAJA;AAKA,OAZA;AAaA,WAbA,CAaA;AACA,0CADA,CACA;AACA,OAfA;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA,OAFA;AAGA,KA9BA;AA+BA,cA/BA,wBA+BA;AACA;AACA,UADA,CACA,iBADA,EACA;AACA,+BADA,EADA;;AAIA,UAJA,CAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCADA;AAEA,gDAFA;AAGA,6CAHA;AAIA,+CAJA;AAKA,4CALA;;AAOA;AACA;AACA;AACA;AACA,mCADA;AAEA,0BAFA,EADA;;AAKA,gBALA;;AAOA;AACA;;AAEA;AACA;AACA;AACA,yCADA;AAEA,2CAFA;;AAIA;AACA,cADA,CACA;AACA;AACA;AACA,iCADA;AAEA,mDAFA;;AAIA;AACA,gBADA,CACA,wBADA;AAEA,iBAFA,CAEA;AACA,uDADA,CACA;AACA,aAJA;AAKA,WAZA;AAaA,eAbA,CAaA;AACA,8CADA,CACA;AACA,WAfA;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA,WAFA;AAGA;AACA,OA3DA;AA4DA,KA5FA;AA6FA,sBA7FA,8BA6FA,CA7FA,EA6FA,EA7FA;AA8FA,QA9FA,kBA8FA;AACA;AACA,gBADA;;AAGA,KAlGA;AAmGA,YAnGA,sBAmGA;AACA;AACA;AACA;AACA;AACA;AACA,0BADA;AAEA,sBAFA;;AAIA;AACA;AACA;AACA;AACA;AACA,wBAdA,CAcA;AACA;AACA,KAnHA;AAoHA,WApHA,qBAoHA;AACA;AACA;AACA;AACA;AACA;AACA,KA1HA;AA2HA,YA3HA,sBA2HA;AACA;AACA;AACA;AACA;AACA;AACA,KAjIA;AAkIA,aAlIA,uBAkIA;AACA;AACA;AACA,+BADA;AAEA,UAFA,CAEA,iBAFA;AAGA,KAvIA;AAwIA;AACA,gBAzIA,wBAyIA,GAzIA,EAyIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAdA;AAeA;AACA,KA1JA;AA2JA,eA3JA,uBA2JA,CA3JA,EA2JA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,KArKA;AAsKA;AACA,WAvKA,mBAuKA,OAvKA,EAuKA,IAvKA,EAuKA;AACA;AACA,KAzKA;AA0KA,eA1KA,uBA0KA,IA1KA,EA0KA,OA1KA,EA0KA;AACA;AACA,sBADA;AAEA,iCAFA,EAEA;AACA;AACA,oBADA;AAEA,8BAFA;AAGA,oCAHA,EAHA;;;AASA;AACA;AACA,KAtLA;;AAwLA,UAxLA,kBAwLA,CAxLA,EAwLA;AACA;AACA,KA1LA;AA2LA,eA3LA,yBA2LA;AACA;AACA;AACA;AACA;AACA;AACA,OALA,MAKA;AACA;AACA;AACA,KApMA;AAqMA,YArMA,oBAqMA,CArMA,EAqMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,OANA;AAOA,KAjNA;AAkNA,sBAlNA,oCAkNA;AACA;AACA;AAFA,2BAGA,CArNA;AAsNA,oBAtNA,mCAsNA;AACA;AACA,KAxNA;AAyNA,iBAzNA,2BAyNA;AACA;AACA;AACA;AACA,cADA,CACA,eADA;AAEA,0BAFA,CAEA;AACA;AACA,SAJA;AAKA,YALA;AAMA,OARA;AASA,KAnOA;AAoOA,gBApOA,0BAoOA;AACA;AACA,KAtOA;AAuOA,gBAvOA,0BAuOA;AACA;AACA,KAzOA,EA5IA,E;;;;;;;;;;;;;ACvGA;AAAA;AAAA;AAAA;AAA+rC,CAAgB,2lCAAG,EAAC,C;;;;;;;;;;;ACAntC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/live/live_play.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/live/live_play.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./live_play.vue?vue&type=template&id=560f43fd&scoped=true&\"\nvar renderjs\nimport script from \"./live_play.vue?vue&type=script&lang=js&\"\nexport * from \"./live_play.vue?vue&type=script&lang=js&\"\nimport style0 from \"./live_play.vue?vue&type=style&index=0&id=560f43fd&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"560f43fd\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/live/live_play.vue\"\nexport default component.exports","export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./live_play.vue?vue&type=template&id=560f43fd&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./live_play.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./live_play.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t<view class=\"\" style=\"position: relative;\" id=\"tc-player\">\r\n\t\t\t<video\r\n\t\t\t\tstyle=\"width: 100%;height: 35vh;\"\r\n\t\t\t\tid=\"myVideo\"\r\n\t\t\t\t:title=\"room_name\"\r\n\t\t\t\tshow-mute-btn\r\n\t\t\t\tenable-play-gesture\r\n\t\t\t\tvslide-gesture\r\n\t\t\t\tenable-auto-rotation\r\n\t\t\t\tautoplay\r\n\t\t\t\t:src=\"options.m3u8\"\r\n\t\t\t\t@error=\"videoErrorCallback\"\r\n\t\t\t\tcontrols\r\n\t\t\t></video>\r\n\t\t\t<text :style=\"{ position: 'absolute', right: '30rpx', top: CustomBar + 10 + 'px' }\" class=\"text-white\">{{ room_num }}人观看</text>\r\n\t\t</view>\r\n\r\n\t\t<view :style=\"{ height: scrollHeight + 'px', width: '100%' }\">\r\n\t\t\t<view class=\"flex\" style=\"height: 80rpx;\">\r\n\t\t\t\t<view\r\n\t\t\t\t\t@click=\"navClick(index)\"\r\n\t\t\t\t\tv-for=\"(item, index) in nav_list\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t:class=\"index == active_index ? 'active_index' : ''\"\r\n\t\t\t\t\tclass=\"nav-item item-center flex-sub\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{{ item }}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<scroll-view\r\n\t\t\t\tid=\"scroll-view\"\r\n\t\t\t\tscroll-y=\"true\"\r\n\t\t\t\tclass=\"\"\r\n\t\t\t\t@scroll=\"scroll\"\r\n\t\t\t\t@scrolltolower=\"reachBottom\"\r\n\t\t\t\t:scroll-top=\"scrollTop\"\r\n\t\t\t\tstyle=\"height:calc(100% - 80rpx);width: 100%;position: relative;\"\r\n\t\t\t>\r\n\t\t\t\t<view id=\"message-main\" class=\" chat \">\r\n\t\t\t\t\t<view v-if=\"active_index == 0\" class=\"animation-slide-left padding-lr padding-tb-sm\">\r\n\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\tclass=\" \"\r\n\t\t\t\t\t\t\tstyle=\"padding-top: 3rpx;padding-bottom: 3rpx;line-height: 1.5;\"\r\n\t\t\t\t\t\t\tv-for=\"(item, index) in msgList\"\r\n\t\t\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t\t\tv-if=\"item.type == TIM.TYPES.MSG_CUSTOM\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<text v-if=\"item.payload.data != 'system'\" style=\"color: #008CFF;\">{{ item.from == userInfo.userId ? userInfo.nick : item.nick }}：</text>\r\n\t\t\t\t\t\t\t<text v-if=\"item.payload.data == 'system'\" style=\"color: rgb(255,0,0);\">系统消息：</text>\r\n\t\t\t\t\t\t\t<text class=\"message-box-content-message\" style=\"flex: 1;\">{{ item.payload.description }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view v-if=\"active_index == 0\" style=\"height: 100rpx;\"></view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-if=\"active_index == 1\" class=\"padding-lr  animation-slide-right padding-tb\">\r\n\t\t\t\t\t\t<view class=\"\">\r\n\t\t\t\t\t\t\t<view class=\"pro-item\" v-for=\"(item, index) in product_list.list\" :key=\"index\" style=\"margin-top: 30upx;\">\r\n\t\t\t\t\t\t\t\t<ProductList :product=\"item\"></ProductList>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t<requestLoading v-if=\"!product_list.init\"></requestLoading>\r\n\t\t\t\t\t\t<empty v-if=\"product_list.init && product_list.list.length == 0\"></empty>\r\n\t\t\t\t\t\t<view class=\"cu-load \" v-if=\"product_list.init && product_list.list.length != 0\" :class=\"product_list.hasmore ? 'loading' : 'over'\"></view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-if=\"active_index == 2\" class=\"animation-slide-right padding-lr-lg padding-tb\">\r\n\t\t\t\t\t\t<requestLoading v-if=\"!product_list.init\"></requestLoading>\r\n\t\t\t\t\t\t<rich-text style=\"line-height: 1.7;\" :nodes=\"company_info.intro\"></rich-text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t\t<view v-if=\"active_index == 0\" class=\"btn_input\" style=\"bottom:0px;padding:20rpx;background-color:#f7f7f7;padding-right:150rpx;\">\r\n\t\t\t\t<input class=\"i-input\" type=\"text\" value=\"\" @click=\"inputKey\" :disabled=\"true\" :focus=\"false\" placeholder=\"说点什么...\" />\r\n\t\t\t\t<likeButton ref=\"likeButton\" :throttle=\"0\">\r\n\t\t\t\t\t<image @click=\"likeClick\" src=\"/static/images/bg1.png\" mode=\"aspectFill\" class=\"i-btn\" style=\"height: 90rpx;width: 90rpx;\"></image>\r\n\t\t\t\t</likeButton>\r\n\t\t\t</view>\r\n\t\t\t<view v-if=\"isInput\" @click=\"keyblur\" class=\"input-mask\">\r\n\t\t\t\t<view class=\"btn_inputs\" :style=\"{ bottom: keyHeight + 'px', padding: '20rpx', 'background-color': '#f7f7f7' }\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclass=\"i-inputs\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tvalue=\"\"\r\n\t\t\t\t\t\t@confirm=\"sendText()\"\r\n\t\t\t\t\t\tv-model=\"textMsg\"\r\n\t\t\t\t\t\tconfirm-type=\"send\"\r\n\t\t\t\t\t\t:focus=\"isFocus\"\r\n\t\t\t\t\t\t@blur=\"keyblur\"\r\n\t\t\t\t\t\tplaceholder=\"说点什么...\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<text class=\"i-btns\" @click=\"sendText()\">发送</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nvar TIM = require('@/static/js/tim-wx.js');\r\nimport ProductList from '@/components/oneproduct.vue';\r\nimport likeButton from './components/like-button.vue';\r\nimport { mapState } from 'vuex';\r\nexport default {\r\n\tcomponents: {\r\n\t\tProductList,\r\n\t\tlikeButton\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\toptions: {\r\n\t\t\t\tautoplay: true,\r\n\t\t\t\tflv: '',\r\n\t\t\t\tm3u8: '',\r\n\t\t\t\tposter: ''\r\n\t\t\t},\r\n\t\t\tuserInfo: {\r\n\t\t\t\tnick: '',\r\n\t\t\t\tavatar: '',\r\n\t\t\t\tuserId: '',\r\n\t\t\t\tuserSig: '',\r\n\t\t\t\tlike_num: ''\r\n\t\t\t},\r\n\t\t\tchatroomId: 0,\r\n\t\t\tlogin: '',\r\n\t\t\tzt: 1,\r\n\t\t\tscrollTop: 0,\r\n\t\t\tscrollHeight: 0,\r\n\t\t\tmsgList: [],\r\n\t\t\t//文字消息\r\n\t\t\ttextMsg: '',\r\n\t\t\tconversationActive: {\r\n\t\t\t\tconversationID: ''\r\n\t\t\t},\r\n\t\t\tnav_list: ['聊天', '推荐产品', '公司简介'],\r\n\t\t\tactive_index: 0,\r\n\t\t\tcompany_info: {},\r\n\t\t\tproduct_list: {\r\n\t\t\t\tp: 1,\r\n\t\t\t\tlist: [],\r\n\t\t\t\thasmore: true,\r\n\t\t\t\tinit: false\r\n\t\t\t},\r\n\t\t\tTIM: null,\r\n\t\t\tkeyHeight: 0,\r\n\t\t\tisFocus: false,\r\n\t\t\tisInput: false,\r\n\t\t\troom_name: '',\r\n\t\t\troom_num: 0,\r\n\t\t\troom_avatar: ''\r\n\t\t};\r\n\t},\r\n\twatch: {\r\n\t\tuserInfo: {\r\n\t\t\thandler(val) {}\r\n\t\t},\r\n\t\tlogin: {\r\n\t\t\thandler(val) {\r\n\t\t\t\t// this.company_product(val);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcurrentMessageList(newVal, oldVal) {\r\n\t\t\tif (newVal.length == 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet data = newVal[newVal.length - 1];\r\n\t\t\tconsole.log(data);\r\n\t\t\tif (data.payload.extension == this.chatroomId) {\r\n\t\t\t\tif (data.payload.data == 'recommend_room_product') {\r\n\t\t\t\t\tconsole.log('推荐产品')\r\n\t\t\t\t} else if (data.payload.data == 'like') {\r\n\t\t\t\t\tif (data.payload.description != this.userInfo.userId) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.$refs.likeButton.handleClick();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (data.payload.data == 'system' || data.payload.data == 'text') {\r\n\t\t\t\t\tif (data.payload.data == 'system') {\r\n\t\t\t\t\t\tif (data.payload.description.includes('进入房间')) {\r\n\t\t\t\t\t\t\tthis.add_room_num();\r\n\t\t\t\t\t\t} else if (data.payload.description.includes('退出房间')) {\r\n\t\t\t\t\t\t\tthis.del_room_num();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.msgList = [...this.msgList, data];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.active_index == 0) {\r\n\t\t\t\tthis.scrollTopCalc();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tcomputed: {\r\n\t\t...mapState({\r\n\t\t\tcurrentMessageList: state => state.currentMessageList,\r\n\t\t\ttim_login: state => state.tim_login\r\n\t\t}),\r\n\t\tStatusBar() {\r\n\t\t\treturn this.$store.state.StatusBar;\r\n\t\t},\r\n\t\tCustomBar() {\r\n\t\t\treturn this.$store.state.CustomBar;\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\tlet _this = this;\r\n\t\t//  监听键盘高度\r\n\t\tuni.onKeyboardHeightChange(res => {\r\n\t\t\t_this.keyHeight = res.height;\r\n\t\t});\r\n\t\t_this.TIM = _this.$TIM;\r\n\t\t_this.$store.commit('createConversationActive', 'GROUPsyb_room');\r\n\t},\r\n\tonLoad(options) {\r\n\t\tif (options.hasOwnProperty('roomid')) {\r\n\t\t\tthis.chatroomId = options.roomid;\r\n\t\t} else {\r\n\t\t\tthis.chatroomId = '3';\r\n\t\t}\r\n\t\tthis.enter_room();\r\n\t\t// 保持屏幕常亮\r\n\t\tuni.setKeepScreenOn({\r\n\t\t\tkeepScreenOn: true\r\n\t\t});\r\n\t},\r\n\r\n\tonUnload() {},\r\n\tdestroyed() {\r\n\t\tuni.setKeepScreenOn({\r\n\t\t\tkeepScreenOn: false\r\n\t\t});\r\n\t},\r\n\tmounted() {\r\n\t\t//获取滚动聊天窗口高度\r\n\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\tquery\r\n\t\t\t.select('#tc-player')\r\n\t\t\t.boundingClientRect(data => {\r\n\t\t\t\tlet windowHeight = uni.getSystemInfoSync().windowHeight;\r\n\t\t\t\tthis.scrollHeight = windowHeight - data.height;\r\n\t\t\t})\r\n\t\t\t.exec();\r\n\t},\r\n\tmethods: {\r\n\t\ttim_online_login() {\r\n\t\t\tlet _this = this;\r\n\t\t\tlet promise = _this.tim.login({\r\n\t\t\t\tuserID: _this.userInfo.userId,\r\n\t\t\t\tuserSig: _this.userInfo.userSig\r\n\t\t\t});\r\n\t\t\tpromise\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\t_this.$store.commit('toggleIsLogin', true);\r\n\t\t\t\t\tlet promise = _this.tim.joinGroup({\r\n\t\t\t\t\t\tgroupID: 'syb_room',\r\n\t\t\t\t\t\ttype: _this.$TIM.TYPES.GRP_AVCHATROOM\r\n\t\t\t\t\t});\r\n\t\t\t\t\tpromise\r\n\t\t\t\t\t\t.then(function(imResponse) {})\r\n\t\t\t\t\t\t.catch(function(imError) {\r\n\t\t\t\t\t\t\tconsole.log('joinGroup error:', imError); // 申请加群失败的相关信息\r\n\t\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tconsole.warn('login error:', err); // 登录失败的相关信息\r\n\t\t\t\t});\r\n\t\t\t_this.tim.on(_this.$TIM.EVENT.SDK_READY, _this.onReadyStateUpdate);\r\n\t\t\t// 收到新消息\r\n\t\t\t_this.tim.on(_this.$TIM.EVENT.MESSAGE_RECEIVED, _this.onReceiveMessage);\r\n\t\t\t// 会话列表更新\r\n\t\t\t_this.tim.on(_this.$TIM.EVENT.CONVERSATION_LIST_UPDATED, event => {\r\n\t\t\t\tthis.$store.commit('updateConversationList', event.data);\r\n\t\t\t});\r\n\t\t},\r\n\t\tenter_room() {\r\n\t\t\tthis.$http\r\n\t\t\t\t.post('enter_live_room', {\r\n\t\t\t\t\troomid: this.chatroomId\r\n\t\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tif (res.data.code == 1) {\r\n\t\t\t\t\t\tthis.options = res.data.list.live_h5;\r\n\t\t\t\t\t\tthis.room_name = res.data.list.live.name;\r\n\t\t\t\t\t\tthis.room_num = res.data.list.online;\r\n\t\t\t\t\t\tthis.room_avatar = res.data.list.list.live_info.avatar;\r\n\t\t\t\t\t\tthis.userInfo = {\r\n\t\t\t\t\t\t\tnick: res.data.list.list.nick,\r\n\t\t\t\t\t\t\tavatar: res.data.list.list.avatarurl,\r\n\t\t\t\t\t\t\tuserId: res.data.list.list.userid,\r\n\t\t\t\t\t\t\tuserSig: res.data.list.list.usersig,\r\n\t\t\t\t\t\t\tlike_num: res.data.list.list.num\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis.zt = res.data.list.list.zt;\r\n\t\t\t\t\t\tif (res.data.list.list.zt == 1) {\r\n\t\t\t\t\t\t\tuni.showToast(\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: '主播还在赶来的路上...',\r\n\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t3000\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.login = res.data.list.list.live_info.login;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// this.tim_online_login();\r\n\t\t\t\t\t\tlet _this = this;\r\n\t\t\t\t\t\tlet promise = _this.tim.login({\r\n\t\t\t\t\t\t\tuserID: _this.userInfo.userId,\r\n\t\t\t\t\t\t\tuserSig: _this.userInfo.userSig\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tpromise\r\n\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\t_this.$store.commit('toggleIsLogin', true);\r\n\t\t\t\t\t\t\t\tlet promise = _this.tim.joinGroup({\r\n\t\t\t\t\t\t\t\t\tgroupID: 'syb_room',\r\n\t\t\t\t\t\t\t\t\ttype: _this.$TIM.TYPES.GRP_AVCHATROOM\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tpromise\r\n\t\t\t\t\t\t\t\t\t.then(function(imResponse) {})\r\n\t\t\t\t\t\t\t\t\t.catch(function(imError) {\r\n\t\t\t\t\t\t\t\t\t\tconsole.log('joinGroup error:', imError); // 申请加群失败的相关信息\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\t\t\tconsole.warn('login error:', err); // 登录失败的相关信息\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t_this.tim.on(_this.$TIM.EVENT.SDK_READY, _this.onReadyStateUpdate);\r\n\t\t\t\t\t\t// 收到新消息\r\n\t\t\t\t\t\t_this.tim.on(_this.$TIM.EVENT.MESSAGE_RECEIVED, _this.onReceiveMessage);\r\n\t\t\t\t\t\t// 会话列表更新\r\n\t\t\t\t\t\t_this.tim.on(_this.$TIM.EVENT.CONVERSATION_LIST_UPDATED, event => {\r\n\t\t\t\t\t\t\tthis.$store.commit('updateConversationList', event.data);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tvideoErrorCallback(e) {},\r\n\t\tback() {\r\n\t\t\tuni.navigateBack({\r\n\t\t\t\tdelta: 1\r\n\t\t\t});\r\n\t\t},\r\n\t\tsendText() {\r\n\t\t\tif (!this.textMsg) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!this.tim_login) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '尚未加入聊天室',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet content = this.replaceEmoji(this.textMsg);\r\n\t\t\tlet msg = { text: content };\r\n\t\t\tthis.sendMsg(msg, 'text');\r\n\t\t\tthis.textMsg = ''; //清空输入框\r\n\t\t\tuni.hideKeyboard();\r\n\t\t},\r\n\t\tkeyblur() {\r\n\t\t\t// 收起键盘\r\n\t\t\tlet _this = this;\r\n\t\t\t_this.isInput = false;\r\n\t\t\t_this.isFocus = false;\r\n\t\t\t_this.keyHeight = 0;\r\n\t\t},\r\n\t\tinputKey() {\r\n\t\t\t//  显示真实的键盘\r\n\t\t\tlet _this = this;\r\n\t\t\t_this.keyHeight = 2000;\r\n\t\t\t_this.isFocus = true;\r\n\t\t\t_this.isInput = true;\r\n\t\t},\r\n\t\tlikeClick() {\r\n\t\t\tthis.tim_sendMsg('like', this.userInfo.userId);\r\n\t\t\tthis.$http.post('like_live_room',{\r\n\t\t\t\troomid:this.chatroomId\r\n\t\t\t}).then(res=>{})\r\n\t\t},\r\n\t\t//替换表情符号为图片\r\n\t\treplaceEmoji(str) {\r\n\t\t\tlet replacedStr = str.replace(/\\[([^(\\]|\\[)]*)\\]/g, (item, index) => {\r\n\t\t\t\tfor (let i = 0; i < this.emojiList.length; i++) {\r\n\t\t\t\t\tlet row = this.emojiList[i];\r\n\t\t\t\t\tfor (let j = 0; j < row.length; j++) {\r\n\t\t\t\t\t\tlet EM = row[j];\r\n\t\t\t\t\t\tif (EM.alt == item) {\r\n\t\t\t\t\t\t\t//在线表情路径，图文混排必须使用网络路径，请上传一份表情到你的服务器后再替换此路径\r\n\t\t\t\t\t\t\t//比如你上传服务器后，你的100.gif路径为https://www.xxx.com/emoji/100.gif 则替换onlinePath填写为https://www.xxx.com/emoji/\r\n\t\t\t\t\t\t\tlet onlinePath = 'https://quan001.y.netsun.com/';\r\n\t\t\t\t\t\t\tlet imgstr = '<img src=\"' + onlinePath + this.onlineEmoji[EM.url] + '\">';\r\n\t\t\t\t\t\t\treturn imgstr;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn replacedStr;\r\n\t\t},\r\n\t\tfliterMyMsg(e) {\r\n\t\t\tif (e.payload.data == 'like') {\r\n\t\t\t\tthis.$refs.likeButton.handleClick();\r\n\t\t\t}else{\r\n\t\t\t\tthis.msgList = [...this.msgList, e];\r\n\t\t\t\tif (this.active_index == 0) {\r\n\t\t\t\t\tthis.scrollTopCalc();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t// 发送消息\r\n\t\tsendMsg(content, type) {\r\n\t\t\tthis.tim_sendMsg('text', content.text);\r\n\t\t},\r\n\t\ttim_sendMsg(type, content) {\r\n\t\t\tlet message = this.tim.createCustomMessage({\r\n\t\t\t\tto: 'syb_room',\r\n\t\t\t\tconversationType: 'GROUP', //C2C或GROUP\r\n\t\t\t\tpayload: {\r\n\t\t\t\t\tdata: type,\r\n\t\t\t\t\tdescription: content,\r\n\t\t\t\t\textension: this.chatroomId\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tlet pomise = this.tim.sendMessage(message);\r\n\t\t\tthis.fliterMyMsg(message);\r\n\t\t},\r\n\r\n\t\tscroll(e) {\r\n\t\t\tthis['session_scroll' + this.active_index] = e.detail.scrollTop;\r\n\t\t},\r\n\t\treachBottom() {\r\n\t\t\tif (this.active_index == 1) {\r\n\t\t\t\tif (!this.product_list.hasmore) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// this.company_product(this.login);\r\n\t\t\t} else {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t},\r\n\t\tnavClick(e) {\r\n\t\t\tif (this.active_index == e) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.active_index = e;\r\n\t\t\tthis.$nextTick(function() {\r\n\t\t\t\tif (e == 0) {\r\n\t\t\t\t\tthis.scrollTopCalc();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.scrollTop = this['session_scroll' + this.active_index] || 0;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tonReadyStateUpdate({ name }) {\r\n\t\t\t//自动监听并更新 sdk 的ready 状态 （未登录是 notReady  登录后是ready）\r\n\t\t\t//sdk ready 后  肯定完成了登录操作    这里可以获取用户存储在im的基础信息/离线消息/黑名单列表\r\n\t\t},\r\n\t\tonReceiveMessage({ data: messageList }) {\r\n\t\t\tthis.$store.commit('pushCurrentMessageList', messageList);\r\n\t\t},\r\n\t\tscrollTopCalc() {\r\n\t\t\tthis.$nextTick(function() {\r\n\t\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\t\tquery\r\n\t\t\t\t\t.select('#message-main')\r\n\t\t\t\t\t.boundingClientRect(data => {\r\n\t\t\t\t\t\tthis.scrollTop = data.height;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.exec();\r\n\t\t\t});\r\n\t\t},\r\n\t\tadd_room_num() {\r\n\t\t\tthis.room_num++;\r\n\t\t},\r\n\t\tdel_room_num() {\r\n\t\t\tthis.room_num--;\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\npage {\r\n\twidth: 100%;\r\n}\r\n\r\n.nav-item {\r\n\tborder-bottom: 1px solid #eee;\r\n}\r\n.active_index {\r\n\tposition: relative;\r\n\tcolor: RGB(255, 125, 35);\r\n\t&::before {\r\n\t\tdisplay: block;\r\n\t\tcontent: '';\r\n\t\theight: 6px;\r\n\t\twidth: 40px;\r\n\t\tbackground-color: RGB(255, 125, 35);\r\n\t\tposition: absolute;\r\n\t\tbottom: 0;\r\n\t\tleft: 50%;\r\n\r\n\t\ttransform: translateX(-50%);\r\n\t}\r\n}\r\n.pro-item:first-child {\r\n\tmargin-top: 0 !important;\r\n}\r\n.i-input {\r\n\theight: 60rpx;\r\n\tline-height: 60rpx;\r\n\tborder-radius: 10rpx;\r\n\tflex: 1;\r\n\tbackground-color: #ffffff;\r\n\tfont-size: 28rpx;\r\n\tpadding: 0 20rpx 0;\r\n}\r\n.i-input_pc {\r\n\theight: 60px;\r\n\tline-height: 60px;\r\n\tborder-radius: 10px;\r\n\tflex: 1;\r\n\tbackground-color: #ffffff;\r\n\tfont-size: 16px;\r\n\tpadding: 0 20px 0;\r\n}\r\n.btn_input {\r\n\tposition: fixed;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n\tbottom: 0rpx;\r\n\theight: 100rpx;\r\n\talign-items: center;\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n}\r\n.btn_input_pc {\r\n\tposition: fixed;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n\tbottom: 0px;\r\n\theight: 80px;\r\n\talign-items: center;\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n}\r\n.i-btn {\r\n\tposition: absolute;\r\n\tright: 20rpx;\r\n\ttop: 50%;\r\n\ttransform: translateY(-50%);\r\n}\r\n.input-mask {\r\n\tposition: fixed;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tbottom: 0;\r\n\tright: 0;\r\n\tbackground-color: rgba(0, 0, 0, 0.1);\r\n}\r\n.i-inputs {\r\n\theight: 60rpx;\r\n\tline-height: 60rpx;\r\n\tborder-radius: 10rpx;\r\n\tflex: 1;\r\n\tbackground-color: #ffffff;\r\n\tfont-size: 28rpx;\r\n\tpadding: 0 20rpx 0;\r\n}\r\n.btn_inputs {\r\n\tposition: fixed;\r\n\tdisplay: flex;\r\n\tbottom: 0rpx;\r\n\theight: 100rpx;\r\n\twidth: 750rpx;\r\n\talign-items: center;\r\n\tflex-direction: row;\r\n}\r\n.i-btns {\r\n\tbackground-color: RGB(239, 43, 44);\r\n\tborder-width: 0;\r\n\tmargin-left: 20rpx;\r\n\tfont-size: 28rpx;\r\n\tcolor: #ffffff;\r\n\theight: 60rpx;\r\n\tline-height: 60rpx;\r\n\tborder-radius: 10rpx;\r\n\tpadding: 0 30rpx;\r\n}\r\n</style>\n","import mod from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./live_play.vue?vue&type=style&index=0&id=560f43fd&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./live_play.vue?vue&type=style&index=0&id=560f43fd&lang=less&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1618963165333\n      var cssReload = require(\"F:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}